SELECT * FROM CHICAGO_CRIME_DATA;
SELECT * FROM CENSUS_DATA;
SELECT * FROM CHICAGO_PUBLIC_SCHOOL;

SELECT COUNT(ID) FROM CHICAGO_CRIME_DATA;
--- 553 CRIMES IN THE DATASET

SELECT MIN(DATE) FIRST_CRIME_DATE, MAX(DATE) LAST_CRIME_DATE, (MAX(DATE)-MIN(DATE)) TIME_SPAN 
	FROM CHICAGO_CRIME_DATA;
--- 17 YEARS OF TIME SPAN

SELECT * FROM CHICAGO_CRIME_DATA LIMIT 10;

SELECT COUNT(ID) FROM CHICAGO_CRIME_DATA WHERE ARREST=TRUE;
--- 163 CRIMES INVOLVED ARREST

SELECT DISTINCT(PRIMARY_TYPE) 
	FROM CHICAGO_CRIME_DATA 
	WHERE LOCATION_DESCRIPTION = 'GAS STATION';
--- 4 TYPES

SELECT COMMUNITY_AREA_NAME
	FROM CENSUS_DATA
	WHERE COMMUNITY_AREA_NAME LIKE 'B%';
--- 5 COMMUNITY AREAS

SELECT NAME_OF_SCHOOL
	FROM CHICAGO_PUBLIC_SCHOOL	
	WHERE HEALTHY_SCHOOL_CERTIFIED=TRUE AND COMMUNITY_AREA_NUMBER in (10,15);
--- Rufus M Hitch Elementary School

SELECT FLOAT(AVG(SAFETY_SCORE)) FROM CHICAGO_PUBLIC_SCHOOL;
--- AVG SAFETY SCORE = 49


SELECT COMMUNITY_AREA_NAME, AVG_ENROLLMENT 
	FROM (SELECT COMMUNITY_AREA_NAME, AVG(COLLEGE_ENROLLMENT) AVG_ENROLLMENT
			FROM CHICAGO_PUBLIC_SCHOOL
			GROUP BY COMMUNITY_AREA_NAME)
	ORDER BY AVG_ENROLLMENT DESC NULLS LAST
	LIMIT 5;
--- ARCHER, MONTCLARE, ... , BELMONT
	
SELECT COMMUNITY_AREA_NAME
	FROM CHICAGO_PUBLIC_SCHOOL
	WHERE SAFETY_SCORE = (SELECT MIN(SAFETY_SCORE) FROM CHICAGO_PUBLIC_SCHOOL);
--- WASHINGTON PARK

SELECT CD.PER_CAPITA_INCOME, CD.COMMUNITY_AREA_NAME, CPS.COMMUNITY_AREA_NAME
	FROM CENSUS_DATA CD, CHICAGO_PUBLIC_SCHOOL CPS
	WHERE UPPER(CD.COMMUNITY_AREA_NAME)=UPPER(CPS.COMMUNITY_AREA_NAME) AND CPS.SAFETY_SCORE=1;
--- 13785


	